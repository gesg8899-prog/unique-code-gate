<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Player Gate â€“ Gold Black</title>
<style>
body { font-family: Arial; background: #000; color: #ffd700; text-align: center; padding: 60px 30px;}
.gate { max-width: 420px; padding: 30px; margin: auto; border-radius: 20px; background: linear-gradient(145deg, #1a1a1a, #000); border: 2px solid #ffd700; box-shadow: 0 0 25px #ffcc00; }
input { width: 80%; padding: 12px; margin-bottom: 15px; border-radius: 10px; border: 1px solid #ffd700; background: #0d0d0d; color: #ffd700; font-size: 16px; }
button { padding: 12px 20px; border-radius: 10px; border: none; background: #ffd700; color: #000; font-weight: bold; font-size: 16px; cursor: pointer; }
button:hover { background: #ffea66; }
.error { color: #ff6666; margin-top: 10px; }
</style>
</head>
<body>
<div class="gate">
  <h1>Enter Your Unique Access Code</h1>
  <p>Input your code to continue</p>
  <input type="text" id="codeInput" placeholder="Enter your code">
  <br>
  <button onclick="enterGame()">Enter</button>
  <p class="error" id="errorMsg"></p>
</div>

<script>
const codesUrl = 'https://gesg8899-prog.github.io/unique-code-gate/player_codes.json';
let codes = [];

// Pakai fetch + CORS safe mode
fetch(codesUrl, { cache: "no-cache" })
  .then(res => {
      if(!res.ok) throw new Error("Failed to fetch codes");
      return res.json();
  })
  .then(data => {
      // Pastikan semua kode uppercase
      codes = data.map(c => ({ code: c.code.toUpperCase(), used: c.used }));
  })
  .catch(err => console.error('Failed to load codes', err));

function enterGame(){
    const inputCode = document.getElementById('codeInput').value.trim().toUpperCase();
    const errorMsg = document.getElementById('errorMsg');
    errorMsg.textContent = '';

    if(!inputCode){ errorMsg.textContent = 'Code cannot be empty'; return; }

    // Cari kode
    const found = codes.find(c => c.code === inputCode);
    if(!found){ errorMsg.textContent = 'Code not found'; return; }

    // Cek jika sudah used
    if(found.used || localStorage.getItem('played_' + inputCode) === 'true'){
        errorMsg.textContent = 'Code already used';
        return;
    }

    // Tandai used di browser
    localStorage.setItem('played_' + inputCode, 'true');

    // Redirect ke Plinko game
    window.location.href = 'https://gesg8899-prog.github.io/plinkoGE88/player_gate.html?code=' + inputCode;
}
</script>
</body>
</html>
